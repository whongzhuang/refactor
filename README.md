# 重构

阅读了一些关于代码的规范和重构的书籍，有一些感想。此文章重点是探索一些更简单可行的实践方式，因为如果按照规范及书中的描述来讲，过于细节，很难在组织内部推行，结合工作实际来看，并不需要面面具到，而是要使用二八原则，代码规范不需要面面具到，只要抓到20%的重点即可到达效益最大化，太细的点没有必要，如果规则少顶多是有遗漏，如果太细太繁琐则可能用不起来。我认为阿里巴巴的规范就是一个反例，该规范中规定了很多细节，这样的规范对于一个良莠不齐的开发团队来讲，非常繁琐，一个事情如果看起来困难，那么用户量就会变少。再好的东西如果用不起来，就不如是东西少点，让用起来。因此我列出了一些很大程度能保证工程至少不至于越来越差的方式(尤其是java)，我会再后续对一些细节进行补充。

## 原则：

1、童子军规，让营地走时比离开时更干净，代码的重构不是一蹴而就，如果每一次离开编辑器的时候能比进来时，补充一些注释、删除一些过时代码、进行一些代码格式化等等，这就是完成了一次有效的重构。

2、火枪手法则，人人为我，我为人人。

3、勇气，重构要有勇气，维持现状是一种强大的力量。

## 一些要点：

1、关于格式：很多代码规范中就代码的空格、换行、间距等等都有比较大幅度的说明，在阿里巴巴的代码规范中也有大幅度的说明，但是就目前来看，这样的说明已无必要，我们无法指望所有的开发人员能够记住这些细节并形成实践。得益于现代编辑器的进步，就格式来讲，只需要两点：一、代码编辑完成后通过编辑器进行格式化(再idea中是ctrl+alt+l)，形成一种习惯。二、所有人的git提交框必须强制勾选提交前格式化按钮。

2、关于注释：接口、类、方法的注释是必要的。虽然在一些重构的书中倡导了代码应该具有自解释性(这一点我完全认同)，但是对于业务很重的一些系统来讲，一个命名则很难描述清楚该文件的作用，因此统一此规范非常必要。

3、关于类：保持单一职责即可，一个类只要一个特性领域的事情，不相干的事情，不要混在一个类中。

4、关于命名：接口、类、方法等的命名应该遵循一个统一的规范，变量等的命令则要简要，易读。最好就这些新增的接口、类、方法规定就行统一评审。

5、关于健壮：必须规定代码编辑器中，不应该存在右侧的黄色警告。在java项目中，单单着一点，即可避免无用的代码、无用的方法、无用的变量、未使用的变量的问题，也可很大程度的避免空指针异常、循环性能等等问题。很多开发人员在开发过程中，右侧的编辑器总是一片黄，这样的代码，无需进行review，不可能是健壮和合理的。

6、卫语句：要想程序变得更好理解，更扁平，卫语句是一个值得使用的方式。程序开发中，经常看到有的开发人员if语句层层嵌套，实际并无必要，通过卫语句及时return、throw、continue程序将变的更扁平和易于阅读。

7、接口的健壮：在这里我指接口的定义，应该尽可能的进行防御式编程，对于不合理的入参要及时抛出并进行提示。

8、异常描述：异常的描述应该对前台使用者可读了，此处要避免程序员思维，编辑一些太过程序化的异常描述。

9、review：定期进行代码code review，这个时间大约是可以每周一次，团队集体进行，团队规模大约1-7人是合理的。这个时间和形式可根据团队自己的习惯进行调整，但必须要有。
